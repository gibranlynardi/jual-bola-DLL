<div id="registerModal" style="display: none; position: fixed; z-index: 50; top: 0; left: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(17, 24, 39, 0.6); backdrop-filter: blur(5px);">
    <div class="max-w-md w-full mx-auto my-12">
        <div class="glassmorphism p-6 sm:p-8">
            <div class="flex items-start justify-between mb-6">
                <div><h3 class="text-2xl font-bold text-white">Create Account</h3></div>
                <button type="button" onclick="hideRegisterModal()" class="text-gray-400 bg-transparent hover:bg-gray-200/20 hover:text-white rounded-lg text-sm p-1.5 ml-auto">&times;</button>
            </div>
            <div id="register-error-container" class="space-y-2 mb-4" style="display: none;"></div>
            <form id="registerForm" class="space-y-4">
                {% csrf_token %}
                <div><label for="reg_username" class="block text-sm font-medium text-gray-200 mb-2">Username</label><input type="text" id="reg_username" name="username" required></div>
                <div><label for="reg_password1" class="block text-sm font-medium text-gray-200 mb-2">Password</label><input type="password" id="reg_password1" name="password" required></div>
                <div><label for="reg_password2" class="block text-sm font-medium text-gray-200 mb-2">Confirm Password</label><input type="password" id="reg_password2" name="password_confirmation" required></div>
                <button type="submit" class="w-full bg-teal-500/80 text-white font-medium py-3 px-4 rounded-lg hover:bg-teal-500">Create Account</button>
            </form>
        </div>
    </div>
</div>
<script>
    function showRegisterModal() { document.getElementById('registerModal').style.display = 'block'; }
    function hideRegisterModal() { document.getElementById('registerModal').style.display = 'none'; }
    document.getElementById("registerForm").addEventListener("submit", async function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        if (formData.get('password') !== formData.get('password_confirmation')) {
            const errorContainer = document.getElementById('register-error-container');
            errorContainer.innerHTML = '<div class="px-4 py-2 rounded-md text-xs border bg-red-500/20 border-red-500/30 text-red-200">Passwords do not match.</div>';
            errorContainer.style.display = 'block';
            return;
        }
        const response = await fetch("{% url 'main:register_ajax' %}", { method: "POST", body: formData });
        const data = await response.json();
        const errorContainer = document.getElementById('register-error-container');

        if (data.status === 'success') {
            hideRegisterModal();
            showToast("Success", data.message, "success");
            setTimeout(() => showLoginModal(), 1500); 
        } else {
            errorContainer.innerHTML = '';
            for (const field in data.errors) {
                data.errors[field].forEach(error => {
                    errorContainer.innerHTML += `<div class="px-4 py-2 rounded-md text-xs border bg-red-500/20 border-red-500/30 text-red-200">${error}</div>`;
                });
            }
            errorContainer.style.display = 'block';
        }
    });
</script>